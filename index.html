<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NAVPU Calculator</title>
<style>
  :root{--accent:#dc3545;--bg:#f6f8fa;--card:#fff;--muted:#6b7280}
  body{font-family:Inter, system-ui, Arial, sans-serif;background:var(--bg);margin:0;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:24px}
  .card{width:100%;max-width:720px;background:var(--card);border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.08);padding:28px}
  h1{margin:0 0 12px;font-size:20px;color:#111}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  label{display:block;font-weight:600;margin-top:10px;color:#222}
  input,select{width:100%;padding:10px;border:1px solid #e6e9ee;border-radius:8px;font-size:14px;margin-top:6px}
  .full{grid-column:1/3}
  button{margin-top:16px;padding:12px 16px;background:var(--accent);color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:700}
  button:hover{opacity:.95}
  .results{margin-top:18px;padding:14px;background:#f1f8ff;border-radius:10px;color:#0b3b66;font-weight:700}
  footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
  a.footer-link{color:var(--accent);text-decoration:none;font-weight:600}
  @media(max-width:720px){.grid{grid-template-columns:1fr}.full{grid-column:1/2}}
</style>
</head>
<body>
  <div class="card" role="main">
    <h1>NAVPU Calculator</h1>

    <div class="grid">
      <div>
        <label for="startNav">Starting NAVPU</label>
        <input id="startNav" type="number" step="0.000001" placeholder="e.g. 10.000000">
      </div>

      <div>
        <label for="startDate">Starting Date</label>
        <input id="startDate" type="date">
      </div>

      <div>
        <label for="endNav">Ending NAVPU</label>
        <input id="endNav" type="number" step="0.000001" placeholder="e.g. 11.000000">
      </div>

      <div>
        <label for="endDate">Ending Date</label>
        <input id="endDate" type="date">
      </div>

      <div>
        <label for="actualAMC">Actual Annual Management Charge (%)</label>
        <input id="actualAMC" type="number" step="0.01" value="2">
      </div>

      <div>
        <label for="simAMC">Simulated Annual Management Charge (%)</label>
        <input id="simAMC" type="number" step="0.01" value="1">
      </div>

      <div class="full">
        <button onclick="calculate()">Calculate</button>
      </div>
    </div>

    <div id="results" class="results" style="display:none"></div>

    <footer>
      Made by <strong>Arnel Legaspi Jr</strong> â€” 
      <a class="footer-link" href="https://linktr.ee/master.fa" target="_blank" rel="noreferrer">linktr.ee/master.fa</a>
    </footer>
  </div>

<script>
function daysBetween(a,b){return Math.round((b-a)/(1000*60*60*24));}
function pow(a,b){return Math.pow(a,b);}

function calculate(){
  const startNav = parseFloat(document.getElementById('startNav').value);
  const endNav = parseFloat(document.getElementById('endNav').value);
  const startDateV = document.getElementById('startDate').value;
  const endDateV = document.getElementById('endDate').value;
  const actualAMC = parseFloat(document.getElementById('actualAMC').value)/100;
  const simAMC = parseFloat(document.getElementById('simAMC').value)/100;

  const resEl = document.getElementById('results');
  resEl.style.display = 'none';
  if(!startNav || !endNav || !startDateV || !endDateV || startNav<=0 || endNav<=0){
    alert('Please fill valid NAVPU values and dates.');
    return;
  }

  const d0 = new Date(startDateV);
  const d1 = new Date(endDateV);
  const days = daysBetween(d0,d1);
  if(days <= 0){ alert('End date must be after start date.'); return; }

  // observed net percent change
  const observedFactor = endNav / startNav;
  const observedPct = (observedFactor - 1) * 100;

  // daily net factor observed
  const dailyNetFactor = pow(observedFactor, 1/days);

  // daily charge factor from actual AMC (compounded daily)
  const dailyChargeFactor_actual = pow(1 - actualAMC, 1/365);
  const dailyChargeFactor_sim = pow(1 - simAMC, 1/365);

  // reverse to get gross daily factor (before fee)
  // dailyGrossFactor * dailyChargeFactor_actual = dailyNetFactor
  const dailyGrossFactor = dailyNetFactor / dailyChargeFactor_actual;

  // compute gross % over period (no fees)
  const grossEndFactor = pow(dailyGrossFactor, days);
  const grossPct = (grossEndFactor - 1) * 100;

  // compute simulated observed with simAMC
  const adjustedDailyNetFactor = dailyGrossFactor * dailyChargeFactor_sim;
  const adjustedEndFactor = pow(adjustedDailyNetFactor, days);
  const adjustedPct = (adjustedEndFactor - 1) * 100;

  resEl.innerHTML =
    `Period: ${days} days<br>` +
    `Observed change (with ${ (actualAMC*100).toFixed(2) }% AMC): <strong>${observedPct.toFixed(6)}%</strong><br>` +
    `Estimated gross change (no AMC): <strong>${grossPct.toFixed(6)}%</strong><br>` +
    `Simulated change if AMC = ${ (simAMC*100).toFixed(2) }%: <strong>${adjustedPct.toFixed(6)}%</strong>`;
  resEl.style.display = 'block';
}
</script>
</body>
</html>
